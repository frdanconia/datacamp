<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Start here • textmineR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="1. Start here">
<meta property="og:description" content="">
<meta property="og:image" content="https://www.rtextmineR.com/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">textmineR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.4.999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_start_here.html">1. Start here</a>
    </li>
    <li>
      <a href="../articles/b_document_clustering.html">2. document clustering</a>
    </li>
    <li>
      <a href="../articles/c_topic_modeling.html">3. Topic modeling</a>
    </li>
    <li>
      <a href="../articles/d_text_embeddings.html">4. Text embeddings</a>
    </li>
    <li>
      <a href="../articles/e_doc_summarization.html">5. Document summarization</a>
    </li>
    <li>
      <a href="../articles/f_tidytext_example.html">6. Using tidytext with textmineR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>1. Start here</h1>
                        <h4 class="author">Thomas W. Jones</h4>
            
            <h4 class="date">2019-11-16</h4>
      
      
      <div class="hidden name"><code>a_start_here.Rmd</code></div>

    </div>

    
    
<div id="why-textminer" class="section level1">
<h1 class="hasAnchor">
<a href="#why-textminer" class="anchor"></a>Why textmineR?</h1>
<p>textmineR was created with three principles in mind:</p>
<ol style="list-style-type: decimal">
<li>Maximize interoperability within R’s ecosystem</li>
<li>Scaleable in terms of object storage and computation time</li>
<li>Syntax that is idiomatic to R</li>
</ol>
<p>R has many packages for text mining and natural language processing (NLP). The <a href="https://CRAN.R-project.org/view=NaturalLanguageProcessing">CRAN task view on natural language processing</a> lists 53 unique packages. Some of these packages are interoperable. Some are not.</p>
<p>textmineR strives for maximum interoperability in three ways. First, it uses the <code>dgCMatrix</code> class from the popular <a href="https://CRAN.R-project.org/package=Matrix"><code>Matrix</code> package</a> for document term matrices (DTMs) and term co-occurrence matrices (TCMs). The <code>Matrix</code> package is an R “recommended” package with nearly 500 packages that depend, import, or suggest it. Compare that to the <a href="https://CRAN.R-project.org/package=slam"><code>slam</code> package</a> used by <a href="https://CRAN.R-project.org/package=tm"><code>tm</code></a> and its derivatives. <code>slam</code> has an order of magnitude fewer dependents. It is simply not as well integrated. <code>Matrix</code> also has methods that make the syntax for manipulating its matrices nearly identical to base R. This greatly reduces the cognitive burden of the programmers.</p>
<p>Second, textmineR relies on base R objects for corpus and metadata storage. Actually, it relies on the user to do so. textmineR’s core functions <code>CreateDtm</code> and <code>CreateTcm</code> take a simple character vector as input. Users may store their corpora as character vectors, lists, or data frames. <em>There is no need to learn a new <a href="https://CRAN.R-project.org/package=tm">‘Corpus’</a> class.</em></p>
<p>Third and last, textmineR represents the output of topic models in a consistent way, a list containing two matrices. This is described in more detail in the next section. Several topic models are supported and the simple representation means that textmineR’s utility functions are usable with outputs from other packages, so long as they are represented as matrices of probabilities. (Again, see the next section for more detail.)</p>
<p>textmineR achieves scalability through three means. First, sparse matrices (like the <code>dgCMatrix</code>) offer significant memory savings. Second, textmineR utilizes <code>Rcpp</code> throughout for speedup. Finally, textmineR uses parallel processing by default where possible. textmineR offers a function <code>TmParallelApply</code> which implements a framework for parallel processing that is syntactically agnostic between Windows and Unix-like operating systems. <code>TmParallelApply</code> is used liberally within textmineR and is exposed for users.</p>
<p>textmineR does make some tradeoffs of performance for syntactic simplicity. textmineR is designed to run on a single node in a cluster computing environment. It can (and will by default) use all available cores of that node. If performance is your number one concern, see <a href="https://CRAN.R-project.org/package=text2vec"><code>text2vec</code></a>. textmineR uses some <code>text2vec</code> under the hood.</p>
<p>textmineR strives for syntax that is idiomatic to R. This is, admittedly, a nebulous concept. textmineR does not create new classes where existing R classes exist. It strives for a functional programming paradigm. And it attempts to group closely-related sequential steps into single functions. This means that users will not have to make several temporary objects along the way. As an example, compare making a document term matrix in textmineR (example below) with <code>tm</code> or <code>text2vec</code>.</p>
<p>As a side note: textmineR’s framework for NLP does not need to be exclusive to textmineR. Text mining packages in R can be interoperable with a few concepts. First, use <code>dgCMatrix</code> for DTMs and TCMs. Second, write most text mining models in a way that they can take a <code>dgCMatrix</code> as the input. Finally, keep non-base R classes to a minimum, especially for corpus and metadata management.</p>
</div>
<div id="corpus-management" class="section level1">
<h1 class="hasAnchor">
<a href="#corpus-management" class="anchor"></a>Corpus management</h1>
<div id="creating-a-dtm" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-dtm" class="anchor"></a>Creating a DTM</h3>
<p>The basic object of analysis for most text mining applications is a document term matrix, or DTM. This is a matrix where every row represents a document and every column represents a token (word, bi-gram, stem, etc.)</p>
<p>You can create a DTM with textmineR by passing a character vector. There are options for stopword removal, creation of n-grams, and other standard data cleaning. There is an option for passing a stemming or lemmatization function if you desire. (See <code><a href="https://rdrr.io/r/utils/help.html">help(CreateDtm)</a></code> for an example using Porter’s word stemmer.)</p>
<p>The code below uses a dataset of movie reviews included with the <code>text2vec</code> package. This dataset is used for sentiment analysis. In addition to the text of the reviews. There is a binary variable indicating positive or negative sentiment. More on this later…</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(textmineR)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Loading required package: Matrix</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Attaching package: 'textmineR'</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; The following object is masked from 'package:Matrix':</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;     update</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;     update</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># load movie_review dataset from text2vec</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(movie_review, <span class="dt">package =</span> <span class="st">"text2vec"</span>)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(movie_review)</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; 'data.frame':    5000 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt;  $ id       : chr  "5814_8" "2381_9" "7759_3" "3630_4" ...</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;  $ sentiment: int  1 1 0 0 1 1 0 0 0 1 ...</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;  $ review   : chr  "With all this stuff going down at the moment with MJ i've started listening to his music, watching the odd docu"| __truncated__ "\\\"The Classic War of the Worlds\\\" by Timothy Hines is a very entertaining film that obviously goes to great"| __truncated__ "The film starts with a manager (Nicholas Bell) giving welcome investors (Robert Carradine) to Primal Park . A s"| __truncated__ "It must be assumed that those who praised this film (\\\"the greatest filmed opera ever,\\\" didn't I read some"| __truncated__ ...</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co"># let's take a sample so the demo will run quickly</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co"># note: textmineR is generally quite scaleable, depending on your system</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(movie_review), <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb1-25" data-line-number="25"></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">movie_review &lt;-<span class="st"> </span>movie_review[ s , ]</a>
<a class="sourceLine" id="cb1-27" data-line-number="27"></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co"># create a document term matrix </span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29">dtm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CreateDtm.html">CreateDtm</a></span>(<span class="dt">doc_vec =</span> movie_review<span class="op">$</span>review, <span class="co"># character vector of documents</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30">                 <span class="dt">doc_names =</span> movie_review<span class="op">$</span>id, <span class="co"># document names, optional</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31">                 <span class="dt">ngram_window =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="co"># minimum and maximum n-gram length</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">                 <span class="dt">stopword_vec =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(stopwords<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html">stopwords</a></span>(<span class="st">"en"</span>), <span class="co"># stopwords from tm</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33">                                  stopwords<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html">stopwords</a></span>(<span class="dt">source =</span> <span class="st">"smart"</span>)), <span class="co"># this is the default value</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34">                 <span class="dt">lower =</span> <span class="ot">TRUE</span>, <span class="co"># lowercase - this is the default value</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35">                 <span class="dt">remove_punctuation =</span> <span class="ot">TRUE</span>, <span class="co"># punctuation - this is the default</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36">                 <span class="dt">remove_numbers =</span> <span class="ot">TRUE</span>, <span class="co"># numbers - this is the default</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37">                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="co"># Turn off status bar for this demo</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38">                 <span class="dt">cpus =</span> <span class="dv">2</span>) <span class="co"># by default, this will be the max number of cpus available</span></a></code></pre></div>
<p>Even though a <code>dgCMatrix</code> isn’t a traditional matrix, it has methods that make it similar to standard R matrices.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(dtm) </a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; [1]   500 56023</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(dtm) </a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; [1] 500</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(dtm) </a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; [1] 56023</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(dtm))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] "tension_creepy"     "underappreciated"   "ends_sparing"      </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; [4] "settings_conjuring" "sarandon"           "everone"</span></a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">colnames(dtm)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">tension_creepy</td>
</tr>
<tr class="even">
<td align="left">underappreciated</td>
</tr>
<tr class="odd">
<td align="left">ends_sparing</td>
</tr>
<tr class="even">
<td align="left">settings_conjuring</td>
</tr>
<tr class="odd">
<td align="left">sarandon</td>
</tr>
<tr class="even">
<td align="left">everone</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(dtm))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rownames(dtm)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">4273_1</td>
</tr>
<tr class="even">
<td align="left">7112_4</td>
</tr>
<tr class="odd">
<td align="left">1891_3</td>
</tr>
<tr class="even">
<td align="left">6252_10</td>
</tr>
<tr class="odd">
<td align="left">9929_2</td>
</tr>
<tr class="even">
<td align="left">8970_10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="basic-corpus-statistics" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-corpus-statistics" class="anchor"></a>Basic corpus statistics</h1>
<p>The code below performs some basic corpus statistics. textmineR has a built in function for getting term frequencies across the corpus. This function <code>TermDocFreq</code> gives term frequencies (equivalent to <code><a href="https://rdrr.io/r/base/colSums.html">colSums(dtm)</a></code>), the number of documents in which each term appears (equivalent to <code><a href="https://rdrr.io/r/base/colSums.html">colSums(dtm &gt; 0)</a></code>), and an inverse-document frequency (IDF) vector. The IDF vector can be used to create a TF-IDF matrix.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># get counts of tokens across the corpus</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">tf_mat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span>(<span class="dt">dtm =</span> dtm)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(tf_mat) </a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 'data.frame':    56023 obs. of  4 variables:</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;  $ term     : chr  "tension_creepy" "underappreciated" "ends_sparing" "settings_conjuring" ...</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;  $ term_freq: num  1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;  $ doc_freq : int  1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;  $ idf      : num  6.21 6.21 6.21 6.21 6.21 ...</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># look at the most frequent tokens</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_mat[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_mat<span class="op">$</span>term_freq, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Ten most frequent tokens</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>br</td>
<td align="left">br</td>
<td align="right">1990</td>
<td align="right">289</td>
<td align="right">0.5481814</td>
</tr>
<tr class="even">
<td>br_br</td>
<td align="left">br_br</td>
<td align="right">999</td>
<td align="right">289</td>
<td align="right">0.5481814</td>
</tr>
<tr class="odd">
<td>film</td>
<td align="left">film</td>
<td align="right">909</td>
<td align="right">294</td>
<td align="right">0.5310283</td>
</tr>
<tr class="even">
<td>movie</td>
<td align="left">movie</td>
<td align="right">774</td>
<td align="right">290</td>
<td align="right">0.5447272</td>
</tr>
<tr class="odd">
<td>good</td>
<td align="left">good</td>
<td align="right">337</td>
<td align="right">209</td>
<td align="right">0.8722738</td>
</tr>
<tr class="even">
<td>time</td>
<td align="left">time</td>
<td align="right">252</td>
<td align="right">167</td>
<td align="right">1.0966143</td>
</tr>
<tr class="odd">
<td>people</td>
<td align="left">people</td>
<td align="right">238</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="even">
<td>story</td>
<td align="left">story</td>
<td align="right">230</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="odd">
<td>great</td>
<td align="left">great</td>
<td align="right">181</td>
<td align="right">125</td>
<td align="right">1.3862944</td>
</tr>
<tr class="even">
<td>bad</td>
<td align="left">bad</td>
<td align="right">176</td>
<td align="right">121</td>
<td align="right">1.4188176</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># look at the most frequent bigrams</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">tf_bigrams &lt;-<span class="st"> </span>tf_mat[ stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(tf_mat<span class="op">$</span>term, <span class="st">"_"</span>) , ]</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_bigrams[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_bigrams<span class="op">$</span>term_freq, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Ten most frequent bi-grams</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>br_br</td>
<td align="left">br_br</td>
<td align="right">999</td>
<td align="right">289</td>
<td align="right">0.5481814</td>
</tr>
<tr class="even">
<td>br_film</td>
<td align="left">br_film</td>
<td align="right">41</td>
<td align="right">35</td>
<td align="right">2.6592600</td>
</tr>
<tr class="odd">
<td>br_movie</td>
<td align="left">br_movie</td>
<td align="right">34</td>
<td align="right">31</td>
<td align="right">2.7806209</td>
</tr>
<tr class="even">
<td>special_effects</td>
<td align="left">special_effects</td>
<td align="right">28</td>
<td align="right">24</td>
<td align="right">3.0365543</td>
</tr>
<tr class="odd">
<td>film_br</td>
<td align="left">film_br</td>
<td align="right">20</td>
<td align="right">17</td>
<td align="right">3.3813948</td>
</tr>
<tr class="even">
<td>good_movie</td>
<td align="left">good_movie</td>
<td align="right">18</td>
<td align="right">17</td>
<td align="right">3.3813948</td>
</tr>
<tr class="odd">
<td>low_budget</td>
<td align="left">low_budget</td>
<td align="right">18</td>
<td align="right">16</td>
<td align="right">3.4420194</td>
</tr>
<tr class="even">
<td>waste_time</td>
<td align="left">waste_time</td>
<td align="right">17</td>
<td align="right">15</td>
<td align="right">3.5065579</td>
</tr>
<tr class="odd">
<td>movie_good</td>
<td align="left">movie_good</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">3.5755508</td>
</tr>
<tr class="even">
<td>movie_br</td>
<td align="left">movie_br</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">3.5065579</td>
</tr>
</tbody>
</table>
<p>It looks like we have stray html tags (“&lt;br&gt;”) in the documents. These aren’t giving us any relevant information about content. (Except, perhaps, that these documents were originally part of web pages.)</p>
<p>The most intuitive approach, perhaps, is to strip these tags from our documents, re-construct a document term matrix, and re-calculate the objects as above. However, a simpler approach would be to simply remove the tokens containing “br” from the DTM we already calculated. This is much more computationally efficient and gives us the same result anyway.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># remove offending tokens from the DTM</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">dtm &lt;-<span class="st"> </span>dtm[ , <span class="op">!</span><span class="st"> </span>stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(dtm),</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                                    <span class="st">"(^br$)|(_br$)|(^br_)"</span>) ]</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co"># re-construct tf_mat and tf_bigrams</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">tf_mat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span>(dtm)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">tf_bigrams &lt;-<span class="st"> </span>tf_mat[ stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(tf_mat<span class="op">$</span>term, <span class="st">"_"</span>) , ]</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_mat[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_mat<span class="op">$</span>term_freq, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;                term term_freq doc_freq       idf</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; film           film       909      294 0.5310283</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; movie         movie       774      290 0.5447272</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; good           good       337      209 0.8722738</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; time           time       252      167 1.0966143</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; people       people       238      143 1.2517635</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; story         story       230      143 1.2517635</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; great         great       181      125 1.3862944</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; bad             bad       176      121 1.4188176</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; made           made       170      140 1.2729657</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; character character       169      108 1.5324769</span></a></code></pre></div>
<table class="table">
<caption>Ten most frequent terms, ‘&lt;br&gt;’ removed</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>film</td>
<td align="left">film</td>
<td align="right">909</td>
<td align="right">294</td>
<td align="right">0.5310283</td>
</tr>
<tr class="even">
<td>movie</td>
<td align="left">movie</td>
<td align="right">774</td>
<td align="right">290</td>
<td align="right">0.5447272</td>
</tr>
<tr class="odd">
<td>good</td>
<td align="left">good</td>
<td align="right">337</td>
<td align="right">209</td>
<td align="right">0.8722738</td>
</tr>
<tr class="even">
<td>time</td>
<td align="left">time</td>
<td align="right">252</td>
<td align="right">167</td>
<td align="right">1.0966143</td>
</tr>
<tr class="odd">
<td>people</td>
<td align="left">people</td>
<td align="right">238</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="even">
<td>story</td>
<td align="left">story</td>
<td align="right">230</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="odd">
<td>great</td>
<td align="left">great</td>
<td align="right">181</td>
<td align="right">125</td>
<td align="right">1.3862944</td>
</tr>
<tr class="even">
<td>bad</td>
<td align="left">bad</td>
<td align="right">176</td>
<td align="right">121</td>
<td align="right">1.4188176</td>
</tr>
<tr class="odd">
<td>made</td>
<td align="left">made</td>
<td align="right">170</td>
<td align="right">140</td>
<td align="right">1.2729657</td>
</tr>
<tr class="even">
<td>character</td>
<td align="left">character</td>
<td align="right">169</td>
<td align="right">108</td>
<td align="right">1.5324769</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_bigrams[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_bigrams<span class="op">$</span>term_freq, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Ten most frequent bi-grams, ‘&lt;br&gt;’ removed</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>special_effects</td>
<td align="left">special_effects</td>
<td align="right">28</td>
<td align="right">24</td>
<td align="right">3.036554</td>
</tr>
<tr class="even">
<td>good_movie</td>
<td align="left">good_movie</td>
<td align="right">18</td>
<td align="right">17</td>
<td align="right">3.381395</td>
</tr>
<tr class="odd">
<td>low_budget</td>
<td align="left">low_budget</td>
<td align="right">18</td>
<td align="right">16</td>
<td align="right">3.442019</td>
</tr>
<tr class="even">
<td>waste_time</td>
<td align="left">waste_time</td>
<td align="right">17</td>
<td align="right">15</td>
<td align="right">3.506558</td>
</tr>
<tr class="odd">
<td>movie_good</td>
<td align="left">movie_good</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">3.575551</td>
</tr>
<tr class="even">
<td>watch_movie</td>
<td align="left">watch_movie</td>
<td align="right">14</td>
<td align="right">13</td>
<td align="right">3.649659</td>
</tr>
<tr class="odd">
<td>real_life</td>
<td align="left">real_life</td>
<td align="right">14</td>
<td align="right">11</td>
<td align="right">3.816713</td>
</tr>
<tr class="even">
<td>watching_movie</td>
<td align="left">watching_movie</td>
<td align="right">14</td>
<td align="right">13</td>
<td align="right">3.649659</td>
</tr>
<tr class="odd">
<td>high_school</td>
<td align="left">high_school</td>
<td align="right">13</td>
<td align="right">7</td>
<td align="right">4.268698</td>
</tr>
<tr class="even">
<td>horror_films</td>
<td align="left">horror_films</td>
<td align="right">13</td>
<td align="right">8</td>
<td align="right">4.135167</td>
</tr>
</tbody>
</table>
<p>We can also calculate how many tokens each document contains from the DTM. Note that this reflects the modifications we made in constructing the DTM (removing stop words, punctuation, numbers, etc.).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># summary of document lengths</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">doc_lengths &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(dtm)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(doc_lengths)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt;      20      97     139     188     222     928</span></a></code></pre></div>
<p>Often,it’s useful to prune your vocabulary and remove any tokens that appear in a small number of documents. This will greatly reduce the vocabulary size (see <a href="https://en.wikipedia.org/wiki/Zipf%27s_law">Zipf’s law</a>) and improve computation time.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># remove any tokens that were in 3 or fewer documents</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">dtm &lt;-<span class="st"> </span>dtm[ , <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(dtm <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> ] <span class="co"># alternatively: dtm[ , tf_mat$term_freq &gt; 3 ]</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">tf_mat &lt;-<span class="st"> </span>tf_mat[ tf_mat<span class="op">$</span>term <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(dtm) , ]</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">tf_bigrams &lt;-<span class="st"> </span>tf_bigrams[ tf_bigrams<span class="op">$</span>term <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(dtm) , ]</a></code></pre></div>
<p>The movie review data set contains more than just text of reviews. It also contains a variable tagging the review as positive (<code>movie_review$sentiment</code> <span class="math inline">\(=1\)</span>) or negative (<code>movie_review$sentiment</code> <span class="math inline">\(=0\)</span>). We can examine terms associated with positive and negative reviews. If we wanted, we could use them to build a simple classifier.</p>
<p>However, as we will see immediately below, looking at only the most frequent terms in each category is not helpful. Because of Zipf’s law, the most frequent terms in just about <em>any</em> category will be the same.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># what words are most associated with sentiment?</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">tf_sentiment &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">positive =</span> <span class="kw"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span>(dtm[ movie_review<span class="op">$</span>sentiment <span class="op">==</span><span class="st"> </span><span class="dv">1</span> , ]),</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                     <span class="dt">negative =</span> <span class="kw"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span>(dtm[ movie_review<span class="op">$</span>sentiment <span class="op">==</span><span class="st"> </span><span class="dv">0</span> , ]))</a></code></pre></div>
<p>These are basically the same. Not helpful at all.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_sentiment<span class="op">$</span>positive[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_sentiment<span class="op">$</span>positive<span class="op">$</span>term_freq, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Ten most-frequent positive tokens</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>film</td>
<td align="left">film</td>
<td align="right">483</td>
<td align="right">151</td>
<td align="right">0.4591837</td>
</tr>
<tr class="even">
<td>movie</td>
<td align="left">movie</td>
<td align="right">340</td>
<td align="right">130</td>
<td align="right">0.6089291</td>
</tr>
<tr class="odd">
<td>good</td>
<td align="left">good</td>
<td align="right">180</td>
<td align="right">106</td>
<td align="right">0.8130245</td>
</tr>
<tr class="even">
<td>great</td>
<td align="left">great</td>
<td align="right">142</td>
<td align="right">93</td>
<td align="right">0.9438641</td>
</tr>
<tr class="odd">
<td>time</td>
<td align="left">time</td>
<td align="right">138</td>
<td align="right">88</td>
<td align="right">0.9991267</td>
</tr>
<tr class="even">
<td>story</td>
<td align="left">story</td>
<td align="right">124</td>
<td align="right">75</td>
<td align="right">1.1589754</td>
</tr>
<tr class="odd">
<td>people</td>
<td align="left">people</td>
<td align="right">107</td>
<td align="right">65</td>
<td align="right">1.3020763</td>
</tr>
<tr class="even">
<td>films</td>
<td align="left">films</td>
<td align="right">102</td>
<td align="right">56</td>
<td align="right">1.4511119</td>
</tr>
<tr class="odd">
<td>love</td>
<td align="left">love</td>
<td align="right">82</td>
<td align="right">53</td>
<td align="right">1.5061716</td>
</tr>
<tr class="even">
<td>made</td>
<td align="left">made</td>
<td align="right">81</td>
<td align="right">67</td>
<td align="right">1.2717709</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_sentiment<span class="op">$</span>negative[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_sentiment<span class="op">$</span>negative<span class="op">$</span>term_freq, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Ten most-frequent negative tokens</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>movie</td>
<td align="left">movie</td>
<td align="right">434</td>
<td align="right">160</td>
<td align="right">0.4893466</td>
</tr>
<tr class="even">
<td>film</td>
<td align="left">film</td>
<td align="right">426</td>
<td align="right">143</td>
<td align="right">0.6016758</td>
</tr>
<tr class="odd">
<td>good</td>
<td align="left">good</td>
<td align="right">157</td>
<td align="right">103</td>
<td align="right">0.9297914</td>
</tr>
<tr class="even">
<td>people</td>
<td align="left">people</td>
<td align="right">131</td>
<td align="right">78</td>
<td align="right">1.2078116</td>
</tr>
<tr class="odd">
<td>bad</td>
<td align="left">bad</td>
<td align="right">130</td>
<td align="right">82</td>
<td align="right">1.1578012</td>
</tr>
<tr class="even">
<td>time</td>
<td align="left">time</td>
<td align="right">114</td>
<td align="right">79</td>
<td align="right">1.1950726</td>
</tr>
<tr class="odd">
<td>story</td>
<td align="left">story</td>
<td align="right">106</td>
<td align="right">68</td>
<td align="right">1.3450127</td>
</tr>
<tr class="even">
<td>character</td>
<td align="left">character</td>
<td align="right">95</td>
<td align="right">60</td>
<td align="right">1.4701758</td>
</tr>
<tr class="odd">
<td>made</td>
<td align="left">made</td>
<td align="right">89</td>
<td align="right">73</td>
<td align="right">1.2740610</td>
</tr>
<tr class="even">
<td>make</td>
<td align="left">make</td>
<td align="right">86</td>
<td align="right">63</td>
<td align="right">1.4213857</td>
</tr>
</tbody>
</table>
<p>That was unhelpful. Instead, we need to re-weight the terms in each class. We’ll use a probabilistic reweighting, described below.</p>
<p>The most frequent words in each class are proportional to <span class="math inline">\(P(word|sentiment_j)\)</span>. As we saw above, that would puts the words in the same order as <span class="math inline">\(P(word)\)</span>, overall. However, we can use the difference in those probabilities to get a new order. That difference is</p>
<p><span class="math display">\[\begin{align}
  P(word|sentiment_j) - P(word)
\end{align}\]</span></p>
<p>You can interpret the difference in (1) as follows: Positive values are more probable in the sentiment class than in the corpus overall. Negative values are less probable. Values close to zero are statistically-independent of sentiment. Since most of the top words are the same when we sort by <span class="math inline">\(P(word|sentiment_j)\)</span>, these words are statistically-independent of sentiment. They get forced towards zero.</p>
<p>For those paying close attention, this difference should give a similar ordering as pointwise-mutual information (PMI), defined as <span class="math inline">\(PMI = \frac{P(word|sentiment_j)}{P(word)}\)</span>. However, I prefer the difference as it is bound between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>The difference method is applied to both words overall and bi-grams in the code below.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co"># let's reweight by probability by class</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">p_words &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(dtm) <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(dtm) <span class="co"># alternatively: tf_mat$term_freq / sum(tf_mat$term_freq)</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">tf_sentiment<span class="op">$</span>positive<span class="op">$</span>conditional_prob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="st">  </span>tf_sentiment<span class="op">$</span>positive<span class="op">$</span>term_freq <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(tf_sentiment<span class="op">$</span>positive<span class="op">$</span>term_freq)</a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">tf_sentiment<span class="op">$</span>positive<span class="op">$</span>prob_lift &lt;-<span class="st"> </span>tf_sentiment<span class="op">$</span>positive<span class="op">$</span>conditional_prob <span class="op">-</span><span class="st"> </span>p_words</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">tf_sentiment<span class="op">$</span>negative<span class="op">$</span>conditional_prob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="st">  </span>tf_sentiment<span class="op">$</span>negative<span class="op">$</span>term_freq <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(tf_sentiment<span class="op">$</span>negative<span class="op">$</span>term_freq)</a>
<a class="sourceLine" id="cb17-12" data-line-number="12"></a>
<a class="sourceLine" id="cb17-13" data-line-number="13">tf_sentiment<span class="op">$</span>negative<span class="op">$</span>prob_lift &lt;-<span class="st"> </span>tf_sentiment<span class="op">$</span>negative<span class="op">$</span>conditional_prob <span class="op">-</span><span class="st"> </span>p_words</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># let's look again with new weights</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_sentiment<span class="op">$</span>positive[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_sentiment<span class="op">$</span>positive<span class="op">$</span>prob_lift, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant terms for positive sentiment</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>great</td>
<td align="left">great</td>
<td align="right">142</td>
<td align="right">93</td>
<td align="right">0.9438641</td>
<td align="right">0.0084009</td>
<td align="right">0.0029998</td>
</tr>
<tr class="even">
<td>film</td>
<td align="left">film</td>
<td align="right">483</td>
<td align="right">151</td>
<td align="right">0.4591837</td>
<td align="right">0.0285748</td>
<td align="right">0.0014502</td>
</tr>
<tr class="odd">
<td>love</td>
<td align="left">love</td>
<td align="right">82</td>
<td align="right">53</td>
<td align="right">1.5061716</td>
<td align="right">0.0048512</td>
<td align="right">0.0012406</td>
</tr>
<tr class="even">
<td>films</td>
<td align="left">films</td>
<td align="right">102</td>
<td align="right">56</td>
<td align="right">1.4511119</td>
<td align="right">0.0060344</td>
<td align="right">0.0010810</td>
</tr>
<tr class="odd">
<td>performance</td>
<td align="left">performance</td>
<td align="right">55</td>
<td align="right">32</td>
<td align="right">2.0107276</td>
<td align="right">0.0032539</td>
<td align="right">0.0008667</td>
</tr>
<tr class="even">
<td>role</td>
<td align="left">role</td>
<td align="right">52</td>
<td align="right">38</td>
<td align="right">1.8388774</td>
<td align="right">0.0030764</td>
<td align="right">0.0008384</td>
</tr>
<tr class="odd">
<td>charlie</td>
<td align="left">charlie</td>
<td align="right">28</td>
<td align="right">3</td>
<td align="right">4.3778513</td>
<td align="right">0.0016565</td>
<td align="right">0.0007911</td>
</tr>
<tr class="even">
<td>excellent</td>
<td align="left">excellent</td>
<td align="right">36</td>
<td align="right">31</td>
<td align="right">2.0424763</td>
<td align="right">0.0021298</td>
<td align="right">0.0006975</td>
</tr>
<tr class="odd">
<td>performances</td>
<td align="left">performances</td>
<td align="right">34</td>
<td align="right">21</td>
<td align="right">2.4319411</td>
<td align="right">0.0020115</td>
<td align="right">0.0006687</td>
</tr>
<tr class="even">
<td>time</td>
<td align="left">time</td>
<td align="right">138</td>
<td align="right">88</td>
<td align="right">0.9991267</td>
<td align="right">0.0081642</td>
<td align="right">0.0006445</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_sentiment<span class="op">$</span>negative[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(tf_sentiment<span class="op">$</span>negative<span class="op">$</span>prob_lift, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ], <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant terms for negative sentiment</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>movie</td>
<td align="left">movie</td>
<td align="right">434</td>
<td align="right">160</td>
<td align="right">0.4893466</td>
<td align="right">0.0261304</td>
<td align="right">0.0030342</td>
</tr>
<tr class="even">
<td>bad</td>
<td align="left">bad</td>
<td align="right">130</td>
<td align="right">82</td>
<td align="right">1.1578012</td>
<td align="right">0.0078271</td>
<td align="right">0.0025752</td>
</tr>
<tr class="odd">
<td>worst</td>
<td align="left">worst</td>
<td align="right">47</td>
<td align="right">39</td>
<td align="right">1.9009588</td>
<td align="right">0.0028298</td>
<td align="right">0.0012483</td>
</tr>
<tr class="even">
<td>pretty</td>
<td align="left">pretty</td>
<td align="right">54</td>
<td align="right">41</td>
<td align="right">1.8509483</td>
<td align="right">0.0032512</td>
<td align="right">0.0010729</td>
</tr>
<tr class="odd">
<td>poor</td>
<td align="left">poor</td>
<td align="right">42</td>
<td align="right">34</td>
<td align="right">2.0381599</td>
<td align="right">0.0025287</td>
<td align="right">0.0009771</td>
</tr>
<tr class="even">
<td>guy</td>
<td align="left">guy</td>
<td align="right">56</td>
<td align="right">28</td>
<td align="right">2.2323159</td>
<td align="right">0.0033717</td>
<td align="right">0.0009248</td>
</tr>
<tr class="odd">
<td>part</td>
<td align="left">part</td>
<td align="right">57</td>
<td align="right">43</td>
<td align="right">1.8033203</td>
<td align="right">0.0034319</td>
<td align="right">0.0008955</td>
</tr>
<tr class="even">
<td>black</td>
<td align="left">black</td>
<td align="right">41</td>
<td align="right">20</td>
<td align="right">2.5687881</td>
<td align="right">0.0024685</td>
<td align="right">0.0008870</td>
</tr>
<tr class="odd">
<td>minutes</td>
<td align="left">minutes</td>
<td align="right">44</td>
<td align="right">32</td>
<td align="right">2.0987845</td>
<td align="right">0.0026492</td>
<td align="right">0.0008588</td>
</tr>
<tr class="even">
<td>stupid</td>
<td align="left">stupid</td>
<td align="right">31</td>
<td align="right">24</td>
<td align="right">2.3864666</td>
<td align="right">0.0018665</td>
<td align="right">0.0008519</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># what about bi-grams?</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">tf_sentiment_bigram &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(tf_sentiment, <span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  x &lt;-<span class="st"> </span>x[ stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(x<span class="op">$</span>term, <span class="st">"_"</span>) , ]</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">  x[ <span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(x<span class="op">$</span>prob_lift, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) , ]</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">})</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_sentiment_bigram<span class="op">$</span>positive, <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant bigrams for positive sentiment</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>makes_movie</td>
<td align="left">makes_movie</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">3.397022</td>
<td align="right">0.0005916</td>
<td align="right">0.0002932</td>
</tr>
<tr class="even">
<td>good_movie</td>
<td align="left">good_movie</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">2.837406</td>
<td align="right">0.0008283</td>
<td align="right">0.0002911</td>
</tr>
<tr class="odd">
<td>high_school</td>
<td align="left">high_school</td>
<td align="right">11</td>
<td align="right">5</td>
<td align="right">3.867026</td>
<td align="right">0.0006508</td>
<td align="right">0.0002629</td>
</tr>
<tr class="even">
<td>star_wars</td>
<td align="left">star_wars</td>
<td align="right">9</td>
<td align="right">5</td>
<td align="right">3.867026</td>
<td align="right">0.0005324</td>
<td align="right">0.0002340</td>
</tr>
<tr class="odd">
<td>great_movie</td>
<td align="left">great_movie</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">3.397022</td>
<td align="right">0.0004733</td>
<td align="right">0.0002047</td>
</tr>
<tr class="even">
<td>highly_recommended</td>
<td align="left">highly_recommended</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">3.684704</td>
<td align="right">0.0003550</td>
<td align="right">0.0001759</td>
</tr>
<tr class="odd">
<td>great_film</td>
<td align="left">great_film</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">3.530553</td>
<td align="right">0.0004733</td>
<td align="right">0.0001749</td>
</tr>
<tr class="even">
<td>movie_great</td>
<td align="left">movie_great</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">3.530553</td>
<td align="right">0.0004733</td>
<td align="right">0.0001749</td>
</tr>
<tr class="odd">
<td>academy_award</td>
<td align="left">academy_award</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">4.090169</td>
<td align="right">0.0002958</td>
<td align="right">0.0001466</td>
</tr>
<tr class="even">
<td>melvyn_douglas</td>
<td align="left">melvyn_douglas</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">4.090169</td>
<td align="right">0.0002958</td>
<td align="right">0.0001466</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(tf_sentiment_bigram<span class="op">$</span>negative, <span class="dv">10</span>)</a></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant bigrams for negative sentiment</caption>
<thead><tr class="header">
<th></th>
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>waste_time</td>
<td align="left">waste_time</td>
<td align="right">16</td>
<td align="right">14</td>
<td align="right">2.925463</td>
<td align="right">0.0009633</td>
<td align="right">0.0004561</td>
</tr>
<tr class="even">
<td>special_effects</td>
<td align="left">special_effects</td>
<td align="right">20</td>
<td align="right">16</td>
<td align="right">2.791932</td>
<td align="right">0.0012042</td>
<td align="right">0.0003686</td>
</tr>
<tr class="odd">
<td>movie_made</td>
<td align="left">movie_made</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">3.261935</td>
<td align="right">0.0006021</td>
<td align="right">0.0002440</td>
</tr>
<tr class="even">
<td>make_sense</td>
<td align="left">make_sense</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0005419</td>
<td align="right">0.0002136</td>
</tr>
<tr class="odd">
<td>scooby_doo</td>
<td align="left">scooby_doo</td>
<td align="right">8</td>
<td align="right">4</td>
<td align="right">4.178226</td>
<td align="right">0.0004817</td>
<td align="right">0.0002131</td>
</tr>
<tr class="even">
<td>worst_movie</td>
<td align="left">worst_movie</td>
<td align="right">7</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0004215</td>
<td align="right">0.0002126</td>
</tr>
<tr class="odd">
<td>read_book</td>
<td align="left">read_book</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">3.485079</td>
<td align="right">0.0004817</td>
<td align="right">0.0001833</td>
</tr>
<tr class="even">
<td>part_movie</td>
<td align="left">part_movie</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0004817</td>
<td align="right">0.0001833</td>
</tr>
<tr class="odd">
<td>good_idea</td>
<td align="left">good_idea</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0003612</td>
<td align="right">0.0001822</td>
</tr>
<tr class="even">
<td>main_character</td>
<td align="left">main_character</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0004817</td>
<td align="right">0.0001534</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#why-textminer">Why textmineR?</a></li>
      <li><a href="#corpus-management">Corpus management</a></li>
      <li><a href="#basic-corpus-statistics">Basic corpus statistics</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tommy Jones.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '3c26218210734fb0fe605f17d745faba',
    indexName: 'rtextminer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
